# PSCAD*  
### \*Python Services Checker & Anomaly Detector
##### Created by Christian Barral Lopez, May 2019  

  This application is the second of the four modules that build ISAT(Internal Security Audit Toolkit).
   A tool built in Python 2.7, executable within every Linux Operating System divided into two modules: 
   The **scanner** module, which focuses on services and OS recognition, and the **sniffer** module, 
   aimed to capture network packets thanks to a MITM (Man In The Middle) technique.  
  
## Installation
   To run this application you need the Python 2.7 interpreter and the Python package manager (pip).
   Please before launching any script that comes with the application, make sure that the Python 2.7 interpreter
   and pip are installed on your system. If they are not:
   - Python 2.7: Install it with your OS package manager(apt, yum pacman...) or download the installer from
   [here](https://www.python.org/download/releases/2.7/).
   - pip: For Python 2.7.9 and greater, this application should come with the installation of Python 2.7,
   but if not, once Python 2.7 is installed, run the `get-pip.py` file located under `packages/` or
   download it from [here](https://bootstrap.pypa.io/get-pip.py). If pip is already installed, update it:
   `pip install --upgrade pip`
     
   Please execute the `install.sh` file or the `offline_install.py` as root
   to install all the modules and applications needed. It is recommended to run the `install.sh` over
    `offline_install.py`
   **If both of this scripts fail it may be because your OS does not install packages with** `apt-get` **or** `dpkg` **, 
   so please install the requirements manually:**
   - Nmap: Install it with your OS package manager (`sudo yum install nmap`, `sudo pacman -S nmap`, ...)
   - netifaces: Install it with pip: `pip install netifaces`
   - reportlab: Install it with pip: `pip install reportlab`
   - scapy: Install it with pip: `pip install scapy`
   - configparser: Install it with pip: `pip install configparser`
   - python-nmap: Install it with pip: `pip install python-nmap`
  
## Launch the application  
The application is launched by the `pscad.py` file located in this directory. Two commands are avaliable to use: `scan` 
and `sniff`.  
To display the commands and a brief description, execute `python pscad.py -h` or `python pscad.py --help`.

#### Scan
To display all the available options for scanning, execute `python pscad.py scan -h` or `python pscad.py scan --help`.

#### Sniff  
To display all the available options for sniffing, execute `python pscad.py sniff -h` or `python pscad.py sniff --help`.
*Warning: Using the sniffer may cause network issues due to the ARP Poisoning performed. It is the user's responsibility
to use it properly,*
**More detailed use of the application with examples are available in the project's documentation.**  

## Troubleshooting  
- **The application says that a directory X is not valid**: Make sure, if your are
 accessing a directory from the current execution path, that the directory starts with "./", like "./X".
- **The scanner does not show any result in the outputted CSV**: The scanner only
writes in the CSV file when the host responded but had no opened ports or there
were some opened ports. If the target could not be scanned, that target will not
appear in the output CSV file.
- **The scanner does not show opened top ports, but they really are**: The scanner does not
scan top ports by default, but well-known ports (1-1024). Use the `-p` parameter to specify
another port range. 
- **Using the** `--output-pdf` **option takes too long**: If it's taking too long,
make sure you do not use the `--closed-ports` parameter, it may cause serious delays
when passing that information to the PDF file.
- **The sniffer does not capture the specified hosts' packets**: Make sure the network
uses dynamic ARP and an ARP Proxy is not configured.  
- **The .log file generated by the** `-i` **parameter from the sniffer shows weird characters
when reading it from the terminal**: Expand your terminal to full screen and that will fix it.

## Disclaimer  
**This application is for private use, unauthorized copyright of this file via any medium is strictly prohibited.**  
The functionalities implemented were made for ethical purposes, the author does not take any responsibility on how other
users may use this application.